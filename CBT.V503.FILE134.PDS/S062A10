*          DATA SET S062A10    AT LEVEL 001 AS OF 03/09/77
*          DATA SET S062A10    AT LEVEL 002 AS OF 10/22/76              00001
R062A10  CSECT                                                          00002
         SPACE 1                                                        00003
*********************************************************************** 00004
*                                                                     * 00005
* THIS MODULE WILL FUNCTION ONLY IN OS/VS2 RELEASE 2 AND LATER        * 00006
* RELEASES (IE. MVS).                                                 * 00007
*                                                                     * 00008
* THIS MODULE WILL ALLOW THE USER TO PERFORM ANY ONE OF THE FOLLOWING * 00009
* OPERATIONS:                                                         * 00010
*                                                                     * 00011
*        1.    DYNAMICALLY ALLOCATE AN EXISTING DISK DATA SET.  ANY   * 00012
*                          DISK DATA SET, INCLUDING AN ISAM DATA SET, * 00013
*                          MAY BE ALLOCATED.                          * 00014
*        2.    DYNAMICALLY ALLOCATE A NEW DISK DATA SET.  ANY VALID   * 00015
*                          DISK DATA SET ORGANIZATION EXCEPT ISAM     * 00016
*                          MAY BE SPECIFIED.                          * 00017
*        3.    DYNAMICALLY ALLOCATE A 'DD DUMMY' DATA SET.            * 00018
*        4.    DYNAMICALLY DE-ALLOCATE A PREVIOUS ALLOCATION.         * 00019
*                                                                     * 00020
* IT IS ASSUMED THAT THE USER OF THIS MODULE HAS A GOOD WORKING       * 00021
* KNOWLEDGE OF OS/VS2 JCL AS DESCRIBED IN THE OS/VS2 JCL MANUAL       * 00022
* (GC28-0692).  THE USER OF THIS MODULE WILL BUILD A LIST OF          * 00023
* PARAMETERS IN MUCH THE SAME WAY AS HE WOULD FILL OUT A 'DD CARD'.   * 00024
* THE INFORMATION IN THE PARAMETER LIST WILL BE USED TO DO THE        * 00025
* REQUESTED FUNCTION.                                                 * 00026
*                                                                     * 00027
* THE LINKAGE TO THIS MODULE CAN BE MADE WITH A STANDARD OS 'CALL',   * 00028
* 'LINK' OR 'ATTACH'.  THE ADDRESS LIST SPECIFIED IN THE 'CALL' (OR   * 00029
* 'LINK' OR 'ATTACH') MUST ALWAYS INCLUDE THE ADDRESS OF THE          * 00030
* PARAMETER LIST (DESCRIBED BELOW) AS ITS FIRST OR ONLY ENTRY.  THE   * 00031
* SECOND (OPTIONAL) ADDRESS IN THE LIST MUST BE THE ADDRESS OF 2      * 00032
* CONSECUTIVE FULLWORDS IN THE CALLER'S PROGRAM.  R13 MUST CONTAIN    * 00033
* THE ADDRESS OF A STANDARD OS SAVE AREA.  EXAMPLES OF CALL'S ARE     * 00034
* SHOWN BELOW.                                                        * 00035
*                                                                     * 00036
*        CALL R062A10,(PARMLIST),VL                                   * 00037
*        CALL R062A10,(PARMLIST,RCODES),VL                            * 00038
*                                                                     * 00039
* UPON RETURN FROM THIS MODULE, R0 AND R15 WILL CONTAIN CODES         * 00040
* INDICATING HOW THE REQUEST COMPLETED.  IF THE SECOND ITEM IS NAMED  * 00041
* IN THE ADDRESS LIST, THEN THE VALUES PLACED IN R0 AND R15 WILL      * 00042
* ALSO BE STORED IN ITS FIRST AND SECOND WORDS, RESPECTIVELY.  THIS   * 00043
* WILL ALLOW PROGRAMS WRITTEN IN COBOL OR OTHER HIGH LEVEL LANGUAGES  * 00044
* TO USE THIS MODULE.  DETAILED INFORMATION ABOUT THE RETURN CODES IS * 00045
* GIVEN FOLLOWING THE INFORMATION ABOUT THE PARAMETER LIST.           * 00046
*                                                                     * 00047
* THIS MODULE IS RE-ENTERABLE.                                        * 00048
*                                                                     * 00049
*********************************************************************** 00050
*********************************************************************** 00051
*                                                                     * 00052
* THE PARAMETER LIST ..........                                       * 00053
*                                                                     * 00054
* UNLESS OTHERWISE NOTED, THE FOLLOWING IS TRUE FOR ALL INFORMATION   * 00055
* YOU PLACE IN THE PARAMETER LIST.                                    * 00056
*                                                                     * 00057
*        1.    CODING A PARAMETER IN THE PARAMETER LIST HAS THE SAME  * 00058
*              EFFECT AS CODING THE SAME PARAMETER IN A JCL DDCARD.   * 00059
*                                                                     * 00060
*        2.    IF A PARAMETER IS TO BE OMITTED, ITS CORRESPONDING     * 00061
*              FIELD SHOULD BE LEFT BLANK.                            * 00062
*                                                                     * 00063
*        3.    OMITTING A PARAMETER FROM THE LIST HAS THE SAME EFFECT * 00064
*              AS OMITTING THE SAME PARAMETER FROM A JCL DDCARD.  IN  * 00065
*              PARTICULAR, IF OMITTING A PARAMETER FROM A JCL DDCARD  * 00066
*              WOULD CAUSE A DEFAULT TO BE TAKEN, THEN OMITTING THE   * 00067
*              PARAMETER FROM THE LIST WILL CAUSE THE SAME DEFAULT TO * 00068
*              BE TAKEN.                                              * 00069
*                                                                     * 00070
*        4.    ALL PARAMETERS SHOULD BE LEFT JUSTIFIED AND PADDED     * 00071
*              WITH BLANKS.  NUMERIC VALUES MAY CONTAIN LEADING       * 00072
*              ZEROS.                                                 * 00073
*                                                                     * 00074
*        5.    FIELDS WITHIN THE PARAMETER LIST WILL BE UNCHANGED     * 00075
*              BY THIS MODULE.                                        * 00076
*                                                                     * 00077
*   FIELD NAME   LENGTH       DESCRIPTION AND COMMENTS                * 00078
*                (BYTES)                                              * 00079
*    DDNAME         8      REQUIRED FOR ALL FUNCTIONS.  THIS MUST BE  * 00080
*                          THE SAME AS THE DDNAME PARAMETER OF THE    * 00081
*                          ACB OR DCB THAT WILL BE USED TO PROCESS    * 00082
*                          THE DATA SET.                              * 00083
*                                                                     * 00084
*    DSNAME        44      THIS FIELD MUST BE FILLED IN WITH THE      * 00085
*                          CORRECT DSNAME WHEN ALLOCATING AN EXISTING * 00086
*                          DATA SET OR WHEN CREATING A NEW PERMANENT  * 00087
*                          DATA SET.  WHEN ALLOCATING A NEW TEMPORARY * 00088
*                          DATA SET IT MAY BE LEFT BLANK OR FILLED IN * 00089
*                          WITH AN '&&DSNAME' IN A MANNER IDENTICAL   * 00090
*                          TO REQUESTING A TEMPORARY DATA SET IN JCL. * 00091
*                          IF 'NULLFILE' IS USED AS A DSNAME, A DUMMY * 00092
*                          DATA SET IS ALLOCATED.  IF THIS FIELD IS   * 00093
*                          FILLED IN WITH ALL X'00', A PREVIOUSLY     * 00094
*                          ALLOCATED DATA SET WITH THE SAME DDNAME    * 00095
*                          WILL BE DE-ALLOCATED.  THE DATA SET NAME   * 00096
*                          SPECIFIED IN THIS FIELD MUST NOT BE A      * 00097
*                          'BACKWARD REFERENCE' (IE. MUST NOT BE      * 00098
*                          *.DDNAME, *.STEPNAME.DDNAME OR             * 00099
*                          *.STEPNAME.PROCSTEPNAME.DDNAME).  THIS     * 00100
*                          FIELD SHOULD NOT CONTAIN A MEMBER NAME OR  * 00101
*                          A GENERATION NUMBER.  USE THE DSMEMBER     * 00102
*                          FIELD TO SPECIFY THAT INFORMATION.         * 00103
*                                                                     * 00104
*                          NOTE: WHEN ALLOCATION IS FOR A DUMMY FILE  * 00105
*                                (IE. WHEN DSNAME IS 'NULLFILE') ONLY * 00106
*                                THE 'DDNAME', 'DSNAME', 'DSFREE' AND * 00107
*                                DCB INFORMATION IS USED BY THIS      * 00108
*                                MODULE.  ANY OTHER INFORMATION IS    * 00109
*                                IGNORED.                             * 00110
*                                WHEN DE-ALLOCATION IS REQUESTED (IE. * 00111
*                                WHEN DSNAME IS ALL X'00') ONLY THE   * 00112
*                                'DDNAME' AND 'DSNAME' INFORMATION IS * 00113
*                                USED BY THIS MODULE.  ANY OTHER      * 00114
*                                INFORMATION IS IGNORED.              * 00115
*                                                                     * 00116
*    DSMEMBER       8      USE THIS FIELD TO SPECIFY A MEMBER OF A    * 00117
*                          PDS OR TO SPECIFY THE GENERATION NUMBER    * 00118
*                          OF A GENERATION DATA SET GROUP.  DO NOT    * 00119
*                          USE PARENTHESES.  (EG. SPECIFY +1 NOT      * 00120
*                          (+1) ).                                    * 00121
*                                                                     * 00122
*    PASSWORD       8      USE THIS FIELD TO SPECIFY THE PASSWORD FOR * 00123
*                          AN EXISTING PASSWORD PROTECTED DATA SET.   * 00124
*                          THERE IS NO JCL EQUIVALENT FOR THIS        * 00125
*                          PARAMETER.                                 * 00126
*                                                                     * 00127
*    DSSTATUS       8      THIS FIELD IS EQUIVALENT TO THE STATUS     * 00128
*                          SUBPARAMETER OF THE JCL 'DISP' PARAMETER.  * 00129
*                          VALID VALUES ARE 'NEW', 'OLD', 'SHR' AND   * 00130
*                          'MOD'.                                     * 00131
*                                                                     * 00132
*    DSNDISP        8      THIS FIELD IS EQUIVALENT TO THE NORMAL     * 00133
*                          TERMINATION DISPOSITION SUBPARAMETER OF    * 00134
*                          THE JCL 'DISP' PARAMETER EXCEPT THAT       * 00135
*                          'PASS' MAY NOT BE SPECIFIED FOR THIS       * 00136
*                          FIELD.  VALID VALUES ARE 'KEEP', 'CATLG',  * 00137
*                          'UNCATLG' AND 'DELETE'.                    * 00138
*                                                                     * 00139
*    DSADISP        8      THIS FIELD IS EQUIVALENT TO THE ABNORMAL   * 00140
*                          TERMINATION DISPOSITION SUBPARAMETER OF    * 00141
*                          THE JCL 'DISP' PARMETER.  VALID VALUES ARE * 00142
*                          'KEEP', 'CATLG', 'UNCATLG' AND 'DELETE'.   * 00143
*                                                                     * 00144
*    DSUNIT         8      USE THIS FIELD TO SPECIFY THE UNIT         * 00145
*                          ADDRESS, GENERIC NAME OR ESOTERIC NAME.    * 00146
*                          (EG. '450', '3330-1', 'SYSDA').            * 00147
*                                                                     * 00148
*       **          8      THIS FIELD IS RESERVED FOR FUTURE USE.  IT * 00149
*                          MUST BE LEFT BLANK.                        * 00150
*                                                                     * 00151
*    DSVOLSER       6      USE THIS FIELD TO SPECIFY THE VOLUME       * 00152
*                          SERIAL NUMBER.  (EG. 'FCITS6').  THIS      * 00153
*                          FIELD MAY ALSO BE SET TO ALL X'00'.  IN    * 00154
*                          THAT CASE THIS MODULE WILL SET THIS FIELD  * 00155
*                          TO THE DATA SET VOLUME SERIAL NUMBER.      * 00156
*                                                                     * 00157
*       **         40      THIS FIELD IS RESERVED FOR FUTURE USE.  IT * 00158
*                          MUST BE LEFT BLANK.                        * 00159
*                                                                     * 00160
*    DSVOLREF      44      SPECIFYING A DSNAME IN THIS FIELD IS       * 00161
*                          EQUIVALENT TO CODING 'VOL=REF=DSNAME' IN   * 00162
*                          A JCL DDCARD.  NOTE THAT THE VALUE GIVEN   * 00163
*                          HERE MUST ALWAYS BE A CATALOGUED DATA SET. * 00164
*                          (IE. IT CANNOT BE A 'PASSED' DATA SET NOR  * 00165
*                          CAN IT BE A BACKWARD REFERENCE SUCH AS     * 00166
*                          *.DDNAME, *.STEPNAME.DDNAME OR             * 00167
*                          *.STEPNAME.PROCSTEPNAME.DDNAME).           * 00168
*                                                                     * 00169
*                          NOTE THAT THE DSVOLSER AND DSVOLREF FIELDS * 00170
*                          ARE MUTUALLY EXCLUSIVE EXCEPT WHEN         * 00171
*                          DSVOLSER HAS BEEN CODED AS ALL X'00'.      * 00172
*                                                                     * 00173
*    DSFREE         8      THIS FIELD IS EQUIVALENT TO THE 'FREE'     * 00174
*                          PARAMETER OF A JCL DDCARD.  VALID VALUES   * 00175
*                          ARE 'END' AND 'CLOSE'.                     * 00176
*                                                                     * 00177
*    DSLABEL        4      USE THIS TO SPECIFY A VALID DISK LABEL     * 00178
*                          TYPE.  VALID VALUES ARE 'SL' AND 'SUL'.    * 00179
*                                                                     * 00180
*    DSINOUT        4      THIS FIELD SHOULD BE CODED WHERE           * 00181
*                          'LABEL=(,,,IN)' OR 'LABEL=(,,,OUT)' WOULD  * 00182
*                          BE CODED IN A JCL DDCARD.  VALID VALUES    * 00183
*                          ARE 'IN' AND 'OUT'.                        * 00184
*                                                                     * 00185
*       **         16      THIS FIELD IS RESERVED FOR FUTURE USE.  IT * 00186
*                          MUST BE LEFT BLANK.                        * 00187
*                                                                     * 00188
*    .... THE NEXT GROUP OF FIELDS ARE APPLICABLE TO 'NEW' DATA SETS  * 00189
*         ONLY.  INFORMATION IN THESE FIELDS WILL BE IGNORED IF THEY  * 00190
*         HAVE BEEN CODED FOR OTHER THAN 'NEW' DATA SETS.             * 00191
*                                                                     * 00192
*    DSPWDLBL       8      SPECIFYING THIS FIELD IS EQUIVALENT TO     * 00193
*                          CODING EITHER 'LABEL=(,,PASSWORD)' OR      * 00194
*                          'LABEL=(,,NOPWREAD)' IN YOUR JCL.  VALID   * 00195
*                          VALUES ARE 'PASSWORD' AND 'NOPWREAD'.      * 00196
*                                                                     * 00197
*    DSDATE        12      SPECIFYING THIS FIELD IS EQUIVALENT TO     * 00198
*                          CODING EITHER 'LABEL=EXPDT=YYDDD' OR       * 00199
*                          'LABEL=RETPD=NNNN' IN YOUR JCL.  VALID     * 00200
*                          VALUES ARE 'EXPDT=YYDDD' AND 'RETPD=NNNN'. * 00201
*                                                                     * 00202
*    DSALLOC        5      THIS FIELD SPECIFIES HOW SPACE IS TO BE    * 00203
*                          ALLOCATED.  VALID VALUES ARE 'TRK', 'CYL'  * 00204
*                          AND 'NNNNN' WHERE THE VALUE OF 'NNNNN' IS  * 00205
*                          THE AVERAGE BLOCK LENGTH.                  * 00206
*                                                                     * 00207
*    DSPRI          6      THIS FIELD SPECIFIES THE PRIMARY           * 00208
*                          ALLOCATION QUANTITY.                       * 00209
*                                                                     * 00210
*    DSSEC          6      THIS FIELD SPECIFIES THE SECONDARY         * 00211
*                          ALLOCATION QUANTITY.                       * 00212
*                                                                     * 00213
*    DSDIR          5      THIS FIELD SPECIFIES THE NUMBER OF         * 00214
*                          DIRECTORY BLOCKS FOR A PDS.                * 00215
*                                                                     * 00216
*    DSRLSE         8      SPECIFYING THIS PARAMETER HAS THE SAME     * 00217
*                          EFFECT AS SPECIFYING THE 'RLSE'            * 00218
*                          SUBPARAMETER OF THE JCL 'SPACE' PARAMETER. * 00219
*                          THE VALID VALUE IS 'RLSE'.                 * 00220
*                                                                     * 00221
*    DSCONTIG       8      SPECIFYING THIS PARAMETER HAS THE SAME     * 00222
*                          EFFECT AS SPECIFYING THE 'CONTIG'          * 00223
*                          SUBPARAMETER OF THE JCL 'SPACE' PARAMETER. * 00224
*                          THE VALID VALUE IS 'CONTIG'.               * 00225
*                                                                     * 00226
*    DSROUND        8      SPECIFYING THIS PARAMETER HAS THE SAME     * 00227
*                          EFFECT AS SPECIFYING THE 'ROUND'           * 00228
*                          SUBPARAMETER OF THE JCL 'SPACE' PARAMETER. * 00229
*                          THE VALID VALUE IS 'ROUND'.                * 00230
*                                                                     * 00231
*       **         24      THIS FIELD IS RESERVED FOR FUTURE USE.  IT * 00232
*                          MUST BE LEFT BLANK.                        * 00233
*                                                                     * 00234
*    .... EXCEPT AS NOTED, THE FOLLOWING INFORMATION IS THE SAME AS   * 00235
*         THAT CONTAINED IN THE JCL 'DCB' PARAMETER.                  * 00236
*                                                                     * 00237
*    DSBLKSI        5      BLOCK SIZE VALUE.  MUST BE NUMERIC.        * 00238
*                                                                     * 00239
*    DSORG          8      FOR NEW DATA SETS, THIS FIELD SPECIFIES    * 00240
*                          THE DESIRED DATA ORGANIZATION.  VALID      * 00241
*                          VALUES ARE 'DA', 'DAU', 'PO', 'POU', 'PS', * 00242
*                          'PSU' AND 'VSAM'.  EXCEPT FOR 'VSAM', THIS * 00243
*                          FIELD IS EQUIVALENT TO THE 'DSORG' JCL     * 00244
*                          SUBPARAMETER.  SPECIFYING 'VSAM' IS        * 00245
*                          EQUIVALENT TO CODING  AMP='AMORG'  IN THE  * 00246
*                          DDCARD.  NOTE THAT ISAM DATA SETS MAY NOT  * 00247
*                          BE ALLOCATED NEW.                          * 00248
*                                                                     * 00249
*                          FOR EXISTING DATA SETS, THIS FIELD MAY BE  * 00250
*                          SPECIFIED AS ALL X'00'.  IN THAT CASE THE  * 00251
*                          ORGANIZATION OF THE DATA SET WILL BE       * 00252
*                          PLACED IN THIS FIELD BY THIS MODULE.  THE  * 00253
*                          VALUE THAT WILL BE RETURNED WILL BE ONE OF * 00254
*                          THE FOLLOWING: 'DA', 'DAU', 'IS', 'ISU',   * 00255
*                          'PO', 'POU', 'PS', 'PSU' OR 'VSAM'.  IF    * 00256
*                          THIS MODULE CANNOT DETERMINE THE DATA SET  * 00257
*                          ORGANIZATION, IT WILL NOT CHANGE THE       * 00258
*                          FIELD.                                     * 00259
*                                                                     * 00260
*    DSKEYLEN       3      THE DATA SET KEYLENGTH.  THE VALUE MUST BE * 00261
*                          NUMERIC.                                   * 00262
*                                                                     * 00263
*    DSLRECL        5      THE DATA SET LOGICAL RECORD LENGTH.  VALID * 00264
*                          VALUES ARE THE NUMERIC VALUE FOR LRECL     * 00265
*                          AND 'X'                                    * 00266
*                                                                     * 00267
*    DSRECFM1       1      THE RECORD FORMAT.  VALID VALUES ARE       * 00268
*                          'F', 'V' AND 'U'.                          * 00269
*                                                                     * 00270
*    DSRECFM2       1      SPECIFIES DATA SET BLOCKING.  THE VALID    * 00271
*                          VALUE IS 'B'.                              * 00272
*                                                                     * 00273
*    DSRECFM3       1      SPECIFIES STANDARD BLOCKS (IF DSRECFM1=F)  * 00274
*                          OR SPANNED RECORDS (IF DSRECFM1=V).  THE   * 00275
*                          VALID VALUE IS 'S'.                        * 00276
*                                                                     * 00277
*    DSRECFM4       1      SPECIFIES TRACK OVERFLOW.  THE VALID VALUE * 00278
*                          IS 'T'.                                    * 00279
*                                                                     * 00280
*    DSRECFM5       1      SPECIFIES THE CARRIAGE CONTROL CHARACTER.  * 00281
*                          VALID VALUES ARE 'A' AND 'M'.              * 00282
*                                                                     * 00283
*    DSRECFM6       1      RESERVED FOR FUTURE USE.  MUST BE BLANK.   * 00284
*                                                                     * 00285
*    DSRECFM7       1      RESERVED FOR FUTURE USE.  MUST BE BLANK.   * 00286
*                                                                     * 00287
*    DSRECFM8       1      RESERVED FOR FUTURE USE.  MUST BE BLANK.   * 00288
*                                                                     * 00289
*    DSDCBDS       44      SPECIFYING A DATA SET NAME HERE IS         * 00290
*                          EQUIVALENT TO CODING 'DCB=DSNAME' IN THE   * 00291
*                          JCL.  NOTE THAT A BACKWARD REFERENCE       * 00292
*                          CANNOT BE CODED.                           * 00293
*                                                                     * 00294
*       **         24      THIS FIELD IS RESERVED FOR FUTURE USE.  IT * 00295
*                          MUST BE LEFT BLANK.                        * 00296
*                                                                     * 00297
*********************************************************************** 00298
*********************************************************************** 00299
*                                                                     * 00300
* RETURN CODES ................                                       * 00301
*                                                                     * 00302
* THIS MODULE USES THE DYNAMIC ALLOCATION ROUTINE DESCRIBED IN THE    * 00303
* OS/VS2 SYSTEMS PROGRAMMING LIBRARY: JOB MANAGEMENT MANUAL           * 00304
* (GC28-0627).  THIS MODULE DOES SOME PRELIMINARY EDITING PRIOR TO    * 00305
* REQUESTING DYNAMIC ALLOCATION.  IF IT FINDS SOME ERROR WHICH        * 00306
* PREVENTS COMPLETION OF THE REQUEST, IT WILL PLACE 15 (DECIMAL) IN   * 00307
* R15.  R0 WILL CONTAIN AN OFFSET FROM THE BEGINNING OF THE PARAMETER * 00308
* LIST TO SHOW WHICH FIELD IS IN ERROR.  FOR EXAMPLE, IF THE          * 00309
* 'DSNDISP' FIELD CONTAINS 'PASS' (WHICH IS INVALID), R0 WILL CONTAIN * 00310
* 76 (DECIMAL) AND R15 WILL CONTAIN 15 (DECIMAL).                     * 00311
*                                                                     * 00312
* UNLESS THIS MODULE DETECTS AN ERROR, IT WILL MAKE A REQUEST TO THE  * 00313
* DYNAMIC ALLOCATION ROUTINE.  THE DYNAMIC ALLOCATION ROUTINE ISSUES  * 00314
* A RETURN CODE IN R15 AND ALSO GIVES AN 'ERROR REASON CODE' AND AN   * 00315
* 'INFORMATIONAL REASON CODE'.  EACH OF THE TWO 'REASON CODES' IS 2   * 00316
* BYTES LONG.  THIS MODULE WILL PLACE THE 'ERROR REASON CODE' IN THE  * 00317
* FIRST 2 BYTES OF R0 AND THE 'INFORMATIONAL REASON CODE' IN THE      * 00318
* SECOND 2 BYTES OF R0.  THIS MODULE WILL LEAVE THE DYNAMIC           * 00319
* ALLOCATION RETURN CODE IN R15.  THE MEANING OF THESE CODES CAN BE   * 00320
* FOUND IN THE MANUAL (GC28-0627) MENTIONED ABOVE.                    * 00321
*                                                                     * 00322
* IT WILL ALWAYS BE POSSIBLE TO KNOW THE MEANING OF AN R0 RETURN CODE * 00323
* (IE. DOES IT CONTAIN AN OFFSET OR DOES IT CONTAIN 'REASON CODES'),  * 00324
* SINCE THE DYNAMIC ALLOCATION ROUTINE NEVER ISSUES A 15 (DECIMAL)    * 00325
* RETURN CODE.  THEREFORE, WHEN R15 CONTAINS 15 (DECIMAL), R0 MUST    * 00326
* CONTAIN AN OFFSET.                                                  * 00327
*                                                                     * 00328
* IF THE PROGRAM THAT INVOKES THIS MODULE PASSES 2 ADDRESSES IN ITS   * 00329
* ADDRESS LIST, THIS MODULE WILL PLACE THE CONTENTS OF R0 AND R15 IN  * 00330
* THE FIRST AND SECOND FULLWORDS, RESPECTIVELY, OF THE SECOND ITEM IN * 00331
* THE ADDRESS LIST.                                                   * 00332
*                                                                     * 00333
*********************************************************************** 00334
         SPACE 3                                                        00335
R0       EQU   0                                                        00336
R1       EQU   1                                                        00337
R2       EQU   2                                                        00338
R3       EQU   3                                                        00339
R4       EQU   4                                                        00340
R5       EQU   5                                                        00341
R6       EQU   6                                                        00342
R7       EQU   7        HAS OFFSET OF CURRENT ENTRY OF PARMLIST         00343
R8       EQU   8        ADDRESS OF CURRENT TEXT POINTER                 00344
R9       EQU   9        ADDRESS OF CURRENT TEXT UNIT                    00345
R10      EQU   10       ADDRESS OF REQUEST BLOCK                        00346
R11      EQU   11       ADDRESS OF CALLER'S PARAMETER LIST              00347
R12      EQU   12       BASE REGISTER                                   00348
R13      EQU   13       WORKAREA ADDRESS (SAVEAREA IS FIRST 72 BYTES)   00349
R14      EQU   14                                                       00350
R15      EQU   15                                                       00351
         EJECT                                                          00352
         USING *,R12                                                    00353
         SAVE  (14,12),,*                                               00354
         LR    R12,R15                                                  00355
         L     R11,0(0,R1)         PICK UP PARAMETER LIST ADDRESS.      00356
         USING PARMLIST,R11                                             00357
         L     R0,WORKLEN                                               00358
GET1     GETMAIN RU,LV=(0),RELATED='FREE1' WORK AREA STORAGE            00359
         LR    R2,R13                                                   00360
         LR    R13,1                                                    00361
         USING WORKAREA,R13                                             00362
         LR    R14,R1              SET UP FOR CLEAR OF WORK AREA.       00363
         L     R15,WORKLEN                                              00364
         SR    R0,R0                                                    00365
         SR    R1,R1                                                    00366
         MVCL  R14,R0              CLEAR WORK AREA TO ALL X'00'         00367
         ST    R2,SAVEAREA+4                                            00368
         ST    R13,8(0,R2)                                              00369
         LA    R10,DYNWORK                                              00370
         USING S99RB,R10                                                00371
         ST    R10,REQBKPTR        POINT TO REQUEST BLOCK.              00372
         OI    REQBKPTR,X'80'                                           00373
         LA    R1,S99RBEND-S99RB   LENGTH OF REQUEST BLOCK.             00374
         STC   R1,S99RBLN                                               00375
         CLC   DSNAME,NULLS        CHECK FOR UNALLOCATION REQUEST.      00376
         BNE   *+12                                                     00377
         MVI   S99VERB,S99VRBUN    REQUEST UNALLOCATION.                00378
         B     *+12                                                     00379
         MVI   S99VERB,S99VRBAL    REQUEST ALLOCATION.                  00380
         OI    S99FLG11,S99NOCNV+S99NOMNT                               00381
         LA    R8,S99RBEND         PICK UP ADDRESS FOR TEXT POINTERS    00382
         ST    R8,S99TXTPP                                              00383
         L     R9,TXPTRSPC         PICK UP SPACE RESERVED FOR TEXT PTRS 00384
         ALR   R9,R8               POINT TO FIRST TEXT UNIT.            00385
         USING S99TUNIT,R9                                              00386
         SPACE 1                                                        00387
* DDNAME **************************                                     00388
         SPACE 1                                                        00389
         LA    R7,DDNAME-PARMLIST  INIT 'OFFSET' REGISTER.              00390
         CLI   S99VERB,S99VRBUN    HAS UNALLOCATION BEEN REQUESTED?     00391
         BNE   *+12                                                     00392
         LA    R1,DUNDDNAM                                              00393
         B     *+8                                                      00394
         LA    R1,DALDDNAM                                              00395
         STH   R1,S99TUKEY                                              00396
         MVI   S99TUNUM+1,1                                             00397
         LA    R14,DDNAME          FIND OUT ACTUAL LENGTH OF DDNAME.    00398
         LA    R15,L'DDNAME                                             00399
         BAL   R1,PP000                                                 00400
         LTR   R15,R15                                                  00401
         BNP   QQ000                                                    00402
         STH   R15,S99TULNG                                             00403
         BCTR  R15,0                                                    00404
         EX    R15,MVCPARM         MOVE DDNAME.                         00405
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00406
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00407
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00408
         CLI   S99VERB,S99VRBUN    HAS UNALLOCATION BEEN REQUESTED?     00409
         BE    MM000               GO DO REQUEST.                       00410
         SPACE 1                                                        00411
* DSNAME **************************                                     00412
         SPACE 1                                                        00413
         LA    R7,DSNAME-PARMLIST  OFFSET                               00414
         CLC   DSNAME,=CL44'NULLFILE ' CHECK FOR DUMMY ALLOCATION.      00415
         BNE   AA100                                                    00416
         LA    R1,DALDUMMY                                              00417
         STH   R1,S99TUKEY                                              00418
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00419
*                                      CLEAR.                           00420
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00421
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00422
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00423
         B     AA190                                                    00424
AA100    EQU   *                                                        00425
         LA    R14,DSNAME                                               00426
         LA    R15,L'DSNAME                                             00427
         BAL   R1,PP000            GET DSNAME LENGTH.                   00428
         LTR   R15,R15                                                  00429
         BNP   AA110                                                    00430
         LA    R1,DALDSNAM                                              00431
         STH   R1,S99TUKEY                                              00432
         MVI   S99TUNUM+1,1                                             00433
         STH   R15,S99TULNG                                             00434
         BCTR  R15,0                                                    00435
         EX    R15,MVCPARM         MOVE DSNAME.                         00436
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00437
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00438
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00439
         SPACE 1                                                        00440
* DSMEMBER ************************                                     00441
         SPACE 1                                                        00442
AA110    EQU   *                                                        00443
         LA    R7,DSMEMBER-PARMLIST                                     00444
         LA    R14,DSMEMBER                                             00445
         LA    R15,L'DSMEMBER                                           00446
         BAL   R1,PP000            GET DSMEMBER LENGTH.                 00447
         LTR   R15,R15                                                  00448
         BNP   AA120                                                    00449
         LA    R1,DALMEMBR                                              00450
         STH   R1,S99TUKEY                                              00451
         MVI   S99TUNUM+1,1                                             00452
         STH   R15,S99TULNG                                             00453
         BCTR  R15,0                                                    00454
         EX    R15,MVCPARM         MOVE DSMEMBER.                       00455
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00456
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00457
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00458
         SPACE 1                                                        00459
* PASSWORD ************************                                     00460
         SPACE 1                                                        00461
AA120    EQU   *                                                        00462
         LA    R7,PASSWORD-PARMLIST                                     00463
         LA    R14,PASSWORD                                             00464
         LA    R15,L'PASSWORD                                           00465
         BAL   R1,PP000            GET PASSWORD LENGTH                  00466
         LTR   R15,R15                                                  00467
         BNP   AA130                                                    00468
         LA    R1,DALPASSW                                              00469
         STH   R1,S99TUKEY                                              00470
         MVI   S99TUNUM+1,1                                             00471
         STH   R15,S99TULNG                                             00472
         BCTR  R15,0                                                    00473
         EX    R15,MVCPARM         MOVE PASSWORD.                       00474
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00475
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00476
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00477
         SPACE 1                                                        00478
* DSSTATUS ************************                                     00479
         SPACE 1                                                        00480
AA130    EQU   *                                                        00481
         LA    R7,DSSTATUS-PARMLIST                                     00482
         LA    R14,DSSTATUS                                             00483
         LA    R15,L'DSSTATUS                                           00484
         BAL   R1,PP000            GET DSSTATUS LENGTH                  00485
         LTR   R15,R15                                                  00486
         BNP   AA140                                                    00487
         LA    R1,DALSTATS                                              00488
         STH   R1,S99TUKEY                                              00489
         MVI   S99TUNUM+1,1                                             00490
         MVI   S99TULNG+1,1                                             00491
         CLC   DSSTATUS,=CL8'OLD '                                      00492
         BNE   *+12                                                     00493
         MVI   S99TUPAR,X'01'                                           00494
         B     AA135                                                    00495
         CLC   DSSTATUS,=CL8'MOD '                                      00496
         BNE   *+12                                                     00497
         MVI   S99TUPAR,X'02'                                           00498
         B     AA135                                                    00499
         CLC   DSSTATUS,=CL8'NEW '                                      00500
         BNE   *+12                                                     00501
         MVI   S99TUPAR,X'04'                                           00502
         B     AA135                                                    00503
         CLC   DSSTATUS,=CL8'SHR '                                      00504
         BNE   QQ000                                                    00505
         MVI   S99TUPAR,X'08'                                           00506
AA135    EQU   *                                                        00507
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00508
         LA    R8,4(0,R8)          NEXT TEXT POINTER                    00509
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00510
         SPACE 1                                                        00511
* DSNDISP *************************                                     00512
         SPACE 1                                                        00513
AA140    EQU   *                                                        00514
         LA    R7,DSNDISP-PARMLIST                                      00515
         LA    R14,DSNDISP                                              00516
         LA    R15,L'DSNDISP                                            00517
         BAL   R1,PP000            GET DSNDISP LENGTH                   00518
         LTR   R15,R15                                                  00519
         BNP   AA150                                                    00520
         LA    R1,DALNDISP                                              00521
         STH   R1,S99TUKEY                                              00522
         MVI   S99TUNUM+1,1                                             00523
         MVI   S99TULNG+1,1                                             00524
         CLC   DSNDISP,=CL8'UNCATLG '                                   00525
         BNE   *+12                                                     00526
         MVI   S99TUPAR,X'01'                                           00527
         B     AA145                                                    00528
         CLC   DSNDISP,=CL8'CATLG   '                                   00529
         BNE   *+12                                                     00530
         MVI   S99TUPAR,X'02'                                           00531
         B     AA145                                                    00532
         CLC   DSNDISP,=CL8'DELETE  '                                   00533
         BNE   *+12                                                     00534
         MVI   S99TUPAR,X'04'                                           00535
         B     AA145                                                    00536
         CLC   DSNDISP,=CL8'KEEP    '                                   00537
         BNE   QQ000                                                    00538
         MVI   S99TUPAR,X'08'                                           00539
AA145    EQU   *                                                        00540
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00541
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00542
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00543
         SPACE 1                                                        00544
* DSADISP *************************                                     00545
         SPACE 1                                                        00546
AA150    EQU   *                                                        00547
         LA    R7,DSADISP-PARMLIST                                      00548
         LA    R14,DSADISP                                              00549
         LA    R15,L'DSADISP                                            00550
         BAL   R1,PP000            GET DSADISP LENGTH                   00551
         LTR   R15,R15                                                  00552
         BNP   AA160                                                    00553
         LA    R1,DALCDISP                                              00554
         STH   R1,S99TUKEY                                              00555
         MVI   S99TUNUM+1,1                                             00556
         MVI   S99TULNG+1,1                                             00557
         CLC   DSADISP,=CL8'UNCATLG '                                   00558
         BNE   *+12                                                     00559
         MVI   S99TUPAR,X'01'                                           00560
         B     AA155                                                    00561
         CLC   DSADISP,=CL8'CATLG   '                                   00562
         BNE   *+12                                                     00563
         MVI   S99TUPAR,X'02'                                           00564
         B     AA155                                                    00565
         CLC   DSADISP,=CL8'DELETE  '                                   00566
         BNE   *+12                                                     00567
         MVI   S99TUPAR,X'04'                                           00568
         B     AA155                                                    00569
         CLC   DSADISP,=CL8'KEEP    '                                   00570
         BNE   QQ000                                                    00571
         MVI   S99TUPAR,X'08'                                           00572
AA155    EQU   *                                                        00573
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00574
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00575
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00576
         SPACE 1                                                        00577
* DSUNIT **************************                                     00578
         SPACE 1                                                        00579
AA160    EQU   *                                                        00580
         LA    R7,DSUNIT-PARMLIST                                       00581
         LA    R14,DSUNIT                                               00582
         LA    R15,L'DSUNIT                                             00583
         BAL   R1,PP000            GET DSUNIT LENGTH                    00584
         LTR   R15,R15                                                  00585
         BNP   AA170                                                    00586
         LA    R1,DALUNIT                                               00587
         STH   R1,S99TUKEY                                              00588
         MVI   S99TUNUM+1,1                                             00589
         STH   R15,S99TULNG                                             00590
         BCTR  R15,0                                                    00591
         EX    R15,MVCPARM         MOVE DSUNIT.                         00592
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00593
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00594
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00595
         SPACE 1                                                        00596
* $RESERV1 ************************                                     00597
         SPACE 1                                                        00598
AA170    EQU   *                                                        00599
         LA    R7,$RESERV1-PARMLIST                                     00600
         CLC   $RESERV1,BLANKS                                          00601
         BNE   QQ000                                                    00602
         SPACE 1                                                        00603
* DSVOLSER ************************                                     00604
         SPACE 1                                                        00605
AA170A   EQU   *                                                        00606
         LA    R7,DSVOLSER-PARMLIST                                     00607
         CLC   DSVOLSER,NULLS                                           00608
         BNE   AA172                                                    00609
         LA    R1,DALRTVOL         SET UP TO HAVE VOLSER RETURNED TO US 00610
         STH   R1,S99TUKEY                                              00611
         MVI   S99TUNUM+1,1                                             00612
         MVI   S99TULNG+1,6                                             00613
         MVC   S99TUPAR(6),BLANKS                                       00614
         LA    R1,S99TUPAR                                              00615
         ST    R1,WKRTNVOL         SAVE ADDRESS OF PARAMETER FIELD.     00616
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00617
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00618
         LA    R9,S99TUPAR+6       NEXT TEXT UNIT.                      00619
         B     AA180                                                    00620
AA172    EQU   *                                                        00621
         LA    R14,DSVOLSER                                             00622
         LA    R15,L'DSVOLSER                                           00623
         BAL   R1,PP000            GET DSVOLSER LENGTH.                 00624
         LTR   R15,R15                                                  00625
         BNP   AA180                                                    00626
         LA    R1,DALVLSER                                              00627
         STH   R1,S99TUKEY                                              00628
         MVI   S99TUNUM+1,1                                             00629
         STH   R15,S99TULNG                                             00630
         BCTR  R15,0                                                    00631
         EX    R15,MVCPARM         MOVE DSVOLSER.                       00632
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00633
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00634
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00635
         SPACE 1                                                        00636
* $RESERV2 ************************                                     00637
         SPACE 1                                                        00638
AA180    EQU   *                                                        00639
         LA    R7,$RESERV2-PARMLIST                                     00640
         CLC   $RESERV2,BLANKS                                          00641
         BNE   QQ000                                                    00642
         SPACE 1                                                        00643
* DSVOLREF ************************                                     00644
         SPACE 1                                                        00645
AA180A   EQU   *                                                        00646
         LA    R7,DSVOLREF-PARMLIST                                     00647
         LA    R14,DSVOLREF                                             00648
         LA    R15,L'DSVOLREF                                           00649
         BAL   R1,PP000            GET DSVOLREF LENGTH.                 00650
         LTR   R15,R15                                                  00651
         BNP   AA190                                                    00652
         CLC   DSVOLSER,BLANKS     CHECK TO SEE THAT DSVOLREF DOES NOT  00653
         BE    AA184                   CONFLICT WITH DSVOLSER.          00654
         CLC   DSVOLSER,NULLS                                           00655
         BNE   QQ000                                                    00656
AA184    EQU   *                                                        00657
         LA    R1,DALVLRDS                                              00658
         STH   R1,S99TUKEY                                              00659
         MVI   S99TUNUM+1,1                                             00660
         STH   R15,S99TULNG                                             00661
         BCTR  R15,0                                                    00662
         EX    R15,MVCPARM         MOVE DSVOLREF.                       00663
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00664
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00665
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00666
         SPACE 1                                                        00667
* DSFREE **************************                                     00668
         SPACE 1                                                        00669
AA190    EQU   *                                                        00670
         LA    R7,DSFREE-PARMLIST                                       00671
         LA    R14,DSFREE                                               00672
         LA    R15,L'DSFREE                                             00673
         BAL   R1,PP000            GET DSFREE LENGTH.                   00674
         LTR   R15,R15                                                  00675
         BNP   AA198                                                    00676
         CLC   DSFREE,=CL8'END   '                                      00677
         BE    AA198                                                    00678
         CLC   DSFREE,=CL8'CLOSE '                                      00679
         BNE   QQ000                                                    00680
         LA    R1,DALCLOSE                                              00681
         STH   R1,S99TUKEY                                              00682
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00683
*                                      CLEAR.                           00684
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00685
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00686
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00687
AA198    EQU   *                                                        00688
         CLC   DSNAME,=CL44'NULLFILE ' CHECK FOR DUMMY ALLOCATION.      00689
         BE    CC100               GO DO DCB PARAMETERS.                00690
         SPACE 1                                                        00691
* DSLABEL *************************                                     00692
         SPACE 1                                                        00693
AA200    EQU   *                                                        00694
         LA    R7,DSLABEL-PARMLIST                                      00695
         LA    R14,DSLABEL                                              00696
         LA    R15,L'DSLABEL                                            00697
         BAL   R1,PP000            GET DSLABEL LENGTH.                  00698
         LTR   R15,R15                                                  00699
         BNP   AA210                                                    00700
         LA    R1,DALLABEL                                              00701
         STH   R1,S99TUKEY                                              00702
         MVI   S99TUNUM+1,1                                             00703
         MVI   S99TULNG+1,1                                             00704
         CLC   DSLABEL,=CL4'SL  '                                       00705
         BNE   *+12                                                     00706
         MVI   S99TUPAR,X'02'                                           00707
         B     AA205                                                    00708
         CLC   DSLABEL,=CL4'SUL '                                       00709
         BNE   QQ000                                                    00710
         MVI   S99TUPAR,X'08'                                           00711
AA205    EQU   *                                                        00712
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00713
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00714
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00715
         SPACE 1                                                        00716
* DSINOUT *************************                                     00717
         SPACE 1                                                        00718
AA210    EQU   *                                                        00719
         LA    R7,DSINOUT-PARMLIST                                      00720
         LA    R14,DSINOUT                                              00721
         LA    R15,L'DSINOUT                                            00722
         BAL   R1,PP000            GET DSINOUT LENGTH                   00723
         LTR   R15,R15                                                  00724
         BNP   AA220                                                    00725
         LA    R1,DALINOUT                                              00726
         STH   R1,S99TUKEY                                              00727
         MVI   S99TUNUM+1,1                                             00728
         MVI   S99TULNG+1,1                                             00729
         CLC   DSINOUT,=CL4'IN  '                                       00730
         BNE   *+12                                                     00731
         MVI   S99TUPAR,X'80'                                           00732
         B     AA215                                                    00733
         CLC   DSINOUT,=CL4'OUT '                                       00734
         BNE   QQ000                                                    00735
         MVI   S99TUPAR,X'40'                                           00736
AA215    EQU   *                                                        00737
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00738
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00739
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00740
         SPACE 1                                                        00741
* $RESERV3 ************************                                     00742
         SPACE 1                                                        00743
AA220    EQU   *                                                        00744
         LA    R7,$RESERV3-PARMLIST                                     00745
         CLC   $RESERV3,BLANKS                                          00746
         BNE   QQ000                                                    00747
         SPACE 3                                                        00748
         CLC   DSSTATUS,BLANKS     CHECK FOR NEW ALLOCATION.            00749
         BE    BB100                                                    00750
         CLC   DSSTATUS,=CL8'NEW '                                      00751
         BNE   CC100               GO DO DCB PARAMETERS.                00752
         EJECT                                                          00753
* DSPWDLBL ************************                                     00754
         SPACE 1                                                        00755
BB100    EQU   *                                                        00756
         LA    R7,DSPWDLBL-PARMLIST                                     00757
         LA    R14,DSPWDLBL                                             00758
         LA    R15,L'DSPWDLBL                                           00759
         BAL   R1,PP000            GET DSPWDLBL LENGTH.                 00760
         LTR   R15,R15                                                  00761
         BNP   BB110                                                    00762
         LA    R1,DALPASPR                                              00763
         STH   R1,S99TUKEY                                              00764
         MVI   S99TUNUM+1,1                                             00765
         MVI   S99TULNG+1,1                                             00766
         CLC   DSPWDLBL,=CL8'PASSWORD'                                  00767
         BNE   *+12                                                     00768
         MVI   S99TUPAR,X'10'                                           00769
         B     BB105                                                    00770
         CLC   DSPWDLBL,=CL8'NOPWREAD'                                  00771
         BNE   QQ000                                                    00772
         MVI   S99TUPAR,X'30'                                           00773
BB105    EQU   *                                                        00774
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00775
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00776
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00777
         SPACE 1                                                        00778
* DSDATE **************************                                     00779
         SPACE 1                                                        00780
BB110    EQU   *                                                        00781
         LA    R7,DSDATE-PARMLIST                                       00782
         LA    R14,DSDATE                                               00783
         LA    R15,L'DSDATE                                             00784
         BAL   R1,PP000            GET DSDATE LENGTH.                   00785
         LTR   R15,R15                                                  00786
         BNP   BB120                                                    00787
         CLC   DSDATE(6),=C'EXPDT=' CHECK FOR DATE TYPE.                00788
         BNE   BB114                                                    00789
         SH    R15,=H'6'                                                00790
         CH    R15,=H'5'           CHECK FOR VALID LENGTH.              00791
         BNE   QQ000                                                    00792
         LA    R14,6(0,R14)        BUMP POINTER FOR MVCPARM             00793
         LA    R1,DALEXPDT                                              00794
         STH   R1,S99TUKEY                                              00795
         MVI   S99TUNUM+1,1                                             00796
         STH   R15,S99TULNG                                             00797
         BCTR  R15,0                                                    00798
         EX    R15,MVCPARM         MOVE EXPDT DATE.                     00799
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00800
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00801
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      00802
         B     BB120                                                    00803
         SPACE 1                                                        00804
BB114    EQU   *                                                        00805
         CLC   DSDATE(6),=C'RETPD='                                     00806
         BNE   QQ000               ERROR                                00807
         SH    R15,=H'6'                                                00808
         BNP   QQ000                                                    00809
         CH    R15,=H'4'                                                00810
         BH    QQ000                                                    00811
         LA    R14,6(0,R14)        BUMP POINTER TO START OF NUMBER.     00812
         BAL   R1,PP100            EDIT AND CONVERT RETPD.              00813
         LA    R1,DALRETPD                                              00814
         STH   R1,S99TUKEY                                              00815
         MVI   S99TUNUM+1,1                                             00816
         MVI   S99TULNG+1,2                                             00817
         STH   R15,S99TUPAR        PLACE RETPD VALUE IN TEXT UNIT.      00818
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00819
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00820
         LA    R9,S99TUPAR+2       NEXT TEXT UNIT.                      00821
         SPACE 1                                                        00822
* DSALLOC *************************                                     00823
         SPACE 1                                                        00824
BB120    EQU   *                                                        00825
         LA    R7,DSALLOC-PARMLIST                                      00826
         LA    R14,DSALLOC                                              00827
         LA    R15,L'DSALLOC                                            00828
         BAL   R1,PP000            GET DSALLOC LENGTH.                  00829
         LTR   R15,R15                                                  00830
         BNP   QQ000               ERROR                                00831
         CLC   DSALLOC,=CL5'TRK '  CHECK FOR TRACK ALLOCATION.          00832
         BNE   BB122                                                    00833
         LA    R1,DALTRK                                                00834
         STH   R1,S99TUKEY                                              00835
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00836
*                                      CLEAR.                           00837
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00838
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00839
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00840
         B     BB130                                                    00841
         SPACE 1                                                        00842
BB122    EQU   *                                                        00843
         CLC   DSALLOC,=CL5'CYL '  CHECK FOR CYLINDER ALLOCATION.       00844
         BNE   BB124                                                    00845
         LA    R1,DALCYL                                                00846
         STH   R1,S99TUKEY                                              00847
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00848
*                                      CLEAR.                           00849
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00850
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00851
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00852
         B     BB130                                                    00853
         SPACE 1                                                        00854
BB124    EQU   *                                                        00855
         BAL   R1,PP100            CHECK FOR AVERAGE BLOCK ALLOCATION.  00856
         LA    R1,DALBLKLN                                              00857
         STH   R1,S99TUKEY                                              00858
         MVI   S99TUNUM+1,1                                             00859
         MVI   S99TULNG+1,3                                             00860
         STCM  R15,B'0111',S99TUPAR                                     00861
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00862
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00863
         LA    R9,S99TUPAR+3       NEXT TEXT UNIT.                      00864
         SPACE 1                                                        00865
* DSPRI ***************************                                     00866
         SPACE 1                                                        00867
BB130    EQU   *                                                        00868
         LA    R7,DSPRI-PARMLIST                                        00869
         LA    R14,DSPRI                                                00870
         LA    R15,L'DSPRI                                              00871
         BAL   R1,PP000            GET DSPRI LENGTH.                    00872
         LTR   R15,R15                                                  00873
         BNP   QQ000                                                    00874
         BAL   R1,PP100            CHECK FOR PRIMARY QUANTITY.          00875
         LA    R1,DALPRIME                                              00876
         STH   R1,S99TUKEY                                              00877
         MVI   S99TUNUM+1,1                                             00878
         MVI   S99TULNG+1,3                                             00879
         STCM  R15,B'0111',S99TUPAR                                     00880
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00881
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00882
         LA    R9,S99TUPAR+3       NEXT TEXT UNIT.                      00883
         SPACE 1                                                        00884
* DSSEC ***************************                                     00885
         SPACE 1                                                        00886
BB140    EQU   *                                                        00887
         LA    R7,DSSEC-PARMLIST                                        00888
         LA    R14,DSSEC                                                00889
         LA    R15,L'DSSEC                                              00890
         BAL   R1,PP000            GET DSSEC LENGTH.                    00891
         LTR   R15,R15                                                  00892
         BNP   BB150                                                    00893
         BAL   R1,PP100            CHECK FOR SECONDARY QUANTITY.        00894
         LA    R1,DALSECND                                              00895
         STH   R1,S99TUKEY                                              00896
         MVI   S99TUNUM+1,1                                             00897
         MVI   S99TULNG+1,3                                             00898
         STCM  R15,B'0111',S99TUPAR                                     00899
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00900
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00901
         LA    R9,S99TUPAR+3       NEXT TEXT UNIT.                      00902
         SPACE 1                                                        00903
* DSDIR ***************************                                     00904
         SPACE 1                                                        00905
BB150    EQU   *                                                        00906
         LA    R7,DSDIR-PARMLIST                                        00907
         LA    R14,DSDIR                                                00908
         LA    R15,L'DSDIR                                              00909
         BAL   R1,PP000            GET DSDIR LENGTH.                    00910
         LTR   R15,R15                                                  00911
         BNP   BB160                                                    00912
         BAL   R1,PP100            CHECK FOR DIRECTORY QUANTITY.        00913
         LA    R1,DALDIR                                                00914
         STH   R1,S99TUKEY                                              00915
         MVI   S99TUNUM+1,1                                             00916
         MVI   S99TULNG+1,3                                             00917
         STCM  R15,B'0111',S99TUPAR                                     00918
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00919
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00920
         LA    R9,S99TUPAR+3       NEXT TEXT UNIT.                      00921
         SPACE 1                                                        00922
* DSRLSE **************************                                     00923
         SPACE 1                                                        00924
BB160    EQU   *                                                        00925
         LA    R7,DSRLSE-PARMLIST                                       00926
         LA    R14,DSRLSE                                               00927
         LA    R15,L'DSRLSE                                             00928
         BAL   R1,PP000            GET DSRLSE LENGTH.                   00929
         LTR   R15,R15                                                  00930
         BNP   BB170                                                    00931
         CLC   DSRLSE,=CL8'RLSE '                                       00932
         BNE   QQ000                                                    00933
         LA    R1,DALRLSE                                               00934
         STH   R1,S99TUKEY                                              00935
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00936
*                                      CLEAR.                           00937
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00938
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00939
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00940
         SPACE 1                                                        00941
* DSCONTIG ************************                                     00942
         SPACE 1                                                        00943
BB170    EQU   *                                                        00944
         LA    R7,DSCONTIG-PARMLIST                                     00945
         LA    R14,DSCONTIG                                             00946
         LA    R15,L'DSCONTIG                                           00947
         BAL   R1,PP000            GET DSCONTIG LENGTH.                 00948
         LTR   R15,R15                                                  00949
         BNP   BB180                                                    00950
         LA    R1,DALSPFRM                                              00951
         STH   R1,S99TUKEY                                              00952
         MVI   S99TUNUM+1,1                                             00953
         MVI   S99TULNG+1,1                                             00954
         CLC   DSCONTIG,=CL8'CONTIG '                                   00955
         BNE   QQ000                                                    00956
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00957
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00958
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      00959
         SPACE 1                                                        00960
* DSROUND *************************                                     00961
         SPACE 1                                                        00962
BB180    EQU   *                                                        00963
         LA    R7,DSROUND-PARMLIST                                      00964
         LA    R14,DSROUND                                              00965
         LA    R15,L'DSROUND                                            00966
         BAL   R1,PP000            GET DSROUND LENGTH.                  00967
         LTR   R15,R15                                                  00968
         BNP   BB190                                                    00969
         CLC   DSROUND,=CL8'ROUND '                                     00970
         BNE   QQ000                                                    00971
         LA    R1,DALROUND                                              00972
         STH   R1,S99TUKEY                                              00973
*                                  S99TUNUM SET TO X'0000' BY WORKAREA  00974
*                                      CLEAR.                           00975
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         00976
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   00977
         LA    R9,S99TUENT         NEXT TEXT UNIT.                      00978
         SPACE 1                                                        00979
* $RESERV4 ************************                                     00980
         SPACE 1                                                        00981
BB190    EQU   *                                                        00982
         LA    R7,$RESERV4-PARMLIST                                     00983
         CLC   $RESERV4,BLANKS                                          00984
         BNE   QQ000                                                    00985
         EJECT                                                          00986
* DSBLKSI *************************                                     00987
         SPACE 1                                                        00988
CC100    EQU   *                                                        00989
         LA    R7,DSBLKSI-PARMLIST                                      00990
         LA    R14,DSBLKSI                                              00991
         LA    R15,L'DSBLKSI                                            00992
         BAL   R1,PP000            GET DSBLKSI LENGTH.                  00993
         LTR   R15,R15                                                  00994
         BNP   CC110                                                    00995
         BAL   R1,PP100            CHECK FOR BLKSIZE VALUE.             00996
         CH    R15,=H'32767'       CHECK FOR MAXIMUM BLOCKSIZE.         00997
         BH    QQ000               ERROR.                               00998
         LA    R1,DALBLKSZ                                              00999
         STH   R1,S99TUKEY                                              01000
         MVI   S99TUNUM+1,1                                             01001
         MVI   S99TULNG+1,2                                             01002
         STH   R15,S99TUPAR                                             01003
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01004
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01005
         LA    R9,S99TUPAR+2       NEXT TEXT UNIT.                      01006
         SPACE 1                                                        01007
* DSORG ***************************                                     01008
         SPACE 1                                                        01009
CC110    EQU   *                                                        01010
         LA    R7,DSORG-PARMLIST                                        01011
         CLC   DSORG,NULLS                                              01012
         BNE   CC112                                                    01013
         LA    R1,DALRTORG         SET UP TO HAVE DSORG RETURNED TO US  01014
         STH   R1,S99TUKEY                                              01015
         MVI   S99TUNUM+1,1                                             01016
         MVI   S99TULNG+1,2                                             01017
         MVC   S99TUPAR(2),NULLS                                        01018
         LA    R1,S99TUPAR                                              01019
         ST    R1,WKRTDSRG         SAVE ADDRESS OF PARAMETER FIELD      01020
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01021
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01022
         LA    R9,S99TUPAR+2       NEXT TEXT UNIT.                      01023
         B     CC120                                                    01024
CC112    EQU   *                                                        01025
         LA    R14,DSORG                                                01026
         LA    R15,L'DSORG                                              01027
         BAL   R1,PP000            GET DSORG LENGTH                     01028
         LTR   R15,R15                                                  01029
         BNP   CC120                                                    01030
         LA    R1,DALDSORG                                              01031
         STH   R1,S99TUKEY                                              01032
         MVI   S99TUNUM+1,1                                             01033
         MVI   S99TULNG+1,2                                             01034
         CLC   DSORG,=CL8'VSAM '                                        01035
         BNE   *+14                                                     01036
         MVC   S99TUPAR(2),=XL2'0008'                                   01037
         B     CC115                                                    01038
         CLC   DSORG,=CL8'PO   '                                        01039
         BNE   *+14                                                     01040
         MVC   S99TUPAR(2),=XL2'0200'                                   01041
         B     CC115                                                    01042
         CLC   DSORG,=CL8'POU  '                                        01043
         BNE   *+14                                                     01044
         MVC   S99TUPAR(2),=XL2'0300'                                   01045
         B     CC115                                                    01046
         CLC   DSORG,=CL8'DA   '                                        01047
         BNE   *+14                                                     01048
         MVC   S99TUPAR(2),=XL2'2000'                                   01049
         B     CC115                                                    01050
         CLC   DSORG,=CL8'DAU  '                                        01051
         BNE   *+14                                                     01052
         MVC   S99TUPAR(2),=XL2'2100'                                   01053
         B     CC115                                                    01054
         CLC   DSORG,=CL8'PS   '                                        01055
         BNE   *+14                                                     01056
         MVC   S99TUPAR(2),=XL2'4000'                                   01057
         B     CC115                                                    01058
         CLC   DSORG,=CL8'PSU  '                                        01059
         BNE   QQ000               ERROR                                01060
         MVC   S99TUPAR(2),=XL2'4100'                                   01061
CC115    EQU   *                                                        01062
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01063
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01064
         LA    R9,S99TUPAR+2       NEXT TEXT UNIT.                      01065
         SPACE 1                                                        01066
* DSKEYLEN ************************                                     01067
         SPACE 1                                                        01068
CC120    EQU   *                                                        01069
         LA    R7,DSKEYLEN-PARMLIST                                     01070
         LA    R14,DSKEYLEN                                             01071
         LA    R15,L'DSKEYLEN                                           01072
         BAL   R1,PP000            GET DSKEYLEN LENGTH.                 01073
         LTR   R15,R15                                                  01074
         BNP   CC130                                                    01075
         BAL   R1,PP100            CHECK FOR KEYLENGTH QUANTITY.        01076
         CH    R15,=H'255'         CHECK FOR MAX KEYLENGTH.             01077
         BH    QQ000               ERROR                                01078
         LA    R1,DALKYLEN                                              01079
         STH   R1,S99TUKEY                                              01080
         MVI   S99TUNUM+1,1                                             01081
         MVI   S99TULNG+1,1                                             01082
         STC   R15,S99TUPAR                                             01083
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01084
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01085
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      01086
         SPACE 1                                                        01087
* DSLRECL *************************                                     01088
         SPACE 1                                                        01089
CC130    EQU   *                                                        01090
         LA    R7,DSLRECL-PARMLIST                                      01091
         LA    R14,DSLRECL                                              01092
         LA    R15,L'DSLRECL                                            01093
         BAL   R1,PP000            GET DSLRECL LENGTH.                  01094
         LTR   R15,R15                                                  01095
         BNP   CC140                                                    01096
         LA    R1,DALLRECL                                              01097
         STH   R1,S99TUKEY                                              01098
         MVI   S99TUNUM+1,1                                             01099
         MVI   S99TULNG+1,2                                             01100
         CLC   DSLRECL,=CL5'X '    CHECK FOR SPANNED RECORDS.           01101
         BNE   *+14                                                     01102
         MVC   S99TUPAR(2),=XL2'8000'                                   01103
         B     CC134                                                    01104
         BAL   R1,PP100            CHECK FOR LRECL QUANTITY.            01105
         CH    R15,=H'32767'                                            01106
         BH    QQ000                                                    01107
         STH   R15,S99TUPAR                                             01108
CC134    EQU   *                                                        01109
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01110
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01111
         LA    R9,S99TUPAR+2       NEXT TEXT UNIT.                      01112
         SPACE 1                                                        01113
* DSRECFM1 THRU DSRECFM8 **********                                     01114
         SPACE 1                                                        01115
CC140    EQU   *                                                        01116
         LA    R7,DSRECFM1-PARMLIST                                     01117
         CLC   DSRECFM,BLANKS      CHECK FOR NO INFORMATION             01118
         BE    CC180                                                    01119
         LA    R1,DALRECFM                                              01120
         STH   R1,S99TUKEY                                              01121
         MVI   S99TUNUM+1,1                                             01122
         MVI   S99TULNG+1,1                                             01123
         CLI   DSRECFM1,C' '                                            01124
         BE    CC144                                                    01125
         CLI   DSRECFM1,C'V'                                            01126
         BNE   *+12                                                     01127
         OI    S99TUPAR,X'40'                                           01128
         B     CC144                                                    01129
         CLI   DSRECFM1,C'F'                                            01130
         BNE   *+12                                                     01131
         OI    S99TUPAR,X'80'                                           01132
         B     CC144                                                    01133
         CLI   DSRECFM1,C'U'                                            01134
         BNE   QQ000               ERROR                                01135
         OI    S99TUPAR,X'C0'                                           01136
         SPACE 1                                                        01137
CC144    EQU   *                                                        01138
         LA    R7,DSRECFM2-PARMLIST                                     01139
         CLI   DSRECFM2,C' '                                            01140
         BE    CC148                                                    01141
         CLI   DSRECFM2,C'B'                                            01142
         BNE   QQ000               ERROR                                01143
         OI    S99TUPAR,X'10'                                           01144
         SPACE 1                                                        01145
CC148    EQU   *                                                        01146
         LA    R7,DSRECFM3-PARMLIST                                     01147
         CLI   DSRECFM3,C' '                                            01148
         BE    CC152                                                    01149
         CLI   DSRECFM3,C'S'                                            01150
         BNE   QQ000               ERROR                                01151
         OI    S99TUPAR,X'08'                                           01152
         SPACE 1                                                        01153
CC152    EQU   *                                                        01154
         LA    R7,DSRECFM4-PARMLIST                                     01155
         CLI   DSRECFM4,C' '                                            01156
         BE    CC156                                                    01157
         CLI   DSRECFM4,C'T'                                            01158
         BNE   QQ000               ERROR                                01159
         OI    S99TUPAR,X'20'                                           01160
         SPACE 1                                                        01161
CC156    EQU   *                                                        01162
         LA    R7,DSRECFM5-PARMLIST                                     01163
         CLI   DSRECFM5,C' '                                            01164
         BE    CC160                                                    01165
         CLI   DSRECFM5,C'M'                                            01166
         BNE   *+12                                                     01167
         OI    S99TUPAR,X'02'                                           01168
         B     CC160                                                    01169
         CLI   DSRECFM5,C'A'                                            01170
         BNE   QQ000               ERROR                                01171
         OI    S99TUPAR,X'04'                                           01172
         SPACE 1                                                        01173
CC160    EQU   *                                                        01174
         LA    R7,DSRECFM6-PARMLIST                                     01175
         CLI   DSRECFM6,C' '                                            01176
         BNE   QQ000               ERROR                                01177
         SPACE 1                                                        01178
CC164    EQU   *                                                        01179
         LA    R7,DSRECFM7-PARMLIST                                     01180
         CLI   DSRECFM7,C' '                                            01181
         BNE   QQ000               ERROR                                01182
         SPACE 1                                                        01183
CC168    EQU   *                                                        01184
         LA    R7,DSRECFM8-PARMLIST                                     01185
         CLI   DSRECFM8,C' '                                            01186
         BNE   QQ000               ERROR                                01187
         SPACE 1                                                        01188
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01189
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01190
         LA    R9,S99TUPAR+1       NEXT TEXT UNIT.                      01191
         SPACE 1                                                        01192
* DSDCBDS *************************                                     01193
         SPACE 1                                                        01194
CC180    EQU   *                                                        01195
         LA    R7,DSDCBDS-PARMLIST                                      01196
         LA    R14,DSDCBDS                                              01197
         LA    R15,L'DSDCBDS                                            01198
         BAL   R1,PP000            GET DSDCBDS LENGTH.                  01199
         LTR   R15,R15                                                  01200
         BNP   CC190                                                    01201
         LA    R1,DALDCBDS                                              01202
         STH   R1,S99TUKEY                                              01203
         MVI   S99TUNUM+1,1                                             01204
         STH   R15,S99TULNG                                             01205
         BCTR  R15,0                                                    01206
         EX    R15,MVCPARM                                              01207
         ST    R9,0(0,R8)          SAVE THIS TEXT UNIT ADDRESS.         01208
         LA    R8,4(0,R8)          NEXT TEXT POINTER.                   01209
         LA    R9,S99TUPAR+1(R15)  NEXT TEXT UNIT.                      01210
         SPACE 1                                                        01211
* $RESERV5 ************************                                     01212
         SPACE 1                                                        01213
CC190    EQU   *                                                        01214
         LA    R7,$RESERV5-PARMLIST                                     01215
         CLC   $RESERV5,BLANKS                                          01216
         BNE   QQ000                                                    01217
         B     MM000               GO DO REQUEST                        01218
         SPACE 3                                                        01219
MVCPARM  MVC   S99TUPAR(0),0(R14)                                       01220
         EJECT                                                          01221
MM000    EQU   *                                                        01222
         SH    R8,=H'4'            BACK UP TO LAST USED TEXT POINTER.   01223
         OI    0(R8),X'80'         INDICATE END OF LIST.                01224
         LA    R1,REQBKPTR         GET THE BEGINNING OF THIS MESS.      01225
         DYNALLOC                                                       01226
         L     R0,S99RSC           PICK UP REASON CODES.                01227
         LTR   R15,R15             CHECK FOR ERRORS.                    01228
         BNZ   ZZ000                                                    01229
         L     R1,WKRTNVOL         CHECK FOR VOLSER RETURN REQUEST.     01230
         LTR   R1,R1                                                    01231
         BZ    MM010                                                    01232
         MVC   DSVOLSER,0(R1)      GIVE CALLER INFO.                    01233
MM010    EQU   *                                                        01234
         L     R1,WKRTDSRG         CHECK FOR DSORG RETURN REQUEST.      01235
         LTR   R1,R1                                                    01236
         BZ    MM020                                                    01237
         CLC   0(2,R1),=XL2'0008'                                       01238
         BNE   *+14                                                     01239
         MVC   DSORG,=CL8'VSAM '                                        01240
         B     MM020                                                    01241
         CLC   0(2,R1),=XL2'0200'                                       01242
         BNE   *+14                                                     01243
         MVC   DSORG,=CL8'PO   '                                        01244
         B     MM020                                                    01245
         CLC   0(2,R1),=XL2'0300'                                       01246
         BNE   *+14                                                     01247
         MVC   DSORG,=CL8'POU  '                                        01248
         B     MM020                                                    01249
         CLC   0(2,R1),=XL2'2000'                                       01250
         BNE   *+14                                                     01251
         MVC   DSORG,=CL8'DA   '                                        01252
         B     MM020                                                    01253
         CLC   0(2,R1),=XL2'2100'                                       01254
         BNE   *+14                                                     01255
         MVC   DSORG,=CL8'DAU  '                                        01256
         B     MM020                                                    01257
         CLC   0(2,R1),=XL2'4000'                                       01258
         BNE   *+14                                                     01259
         MVC   DSORG,=CL8'PS   '                                        01260
         B     MM020                                                    01261
         CLC   0(2,R1),=XL2'4100'                                       01262
         BNE   *+14                                                     01263
         MVC   DSORG,=CL8'PSU  '                                        01264
         B     MM020                                                    01265
         CLC   0(2,R1),=XL2'8000'                                       01266
         BNE   *+14                                                     01267
         MVC   DSORG,=CL8'IS   '                                        01268
         B     MM020                                                    01269
         CLC   0(2,R1),=XL2'8100'                                       01270
         BNE   MM020                                                    01271
         MVC   DSORG,=CL8'ISU  '                                        01272
MM020    EQU   *                                                        01273
         B     ZZ000                                                    01274
         EJECT                                                          01275
PP000    EQU   *                   ROUTINE TO DETERMINE LENGTH OF       01276
         LTR   R15,R15                 NON-BLANK CHARACTERS IN FIELD.   01277
         BNP   PP030                   AT ENTRY R1 CONTAINS THE RETURN  01278
         ALR   R15,R14                 ADDRESS.  R14 CONTAINS FIELD     01279
PP010    EQU   *                       ADDRESS.  R15 CONTAINS LENGTH    01280
         BCTR  R15,0                   OF FIELD.  AT EXIT R15 WILL BE   01281
         CLI   0(R15),C' '             ALTERED TO CONTAIN LENGTH OF     01282
         BNE   PP020                   NON-BLANK CHARACTERS IN FIELD.   01283
         CLR   R15,R14                                                  01284
         BH    PP010                                                    01285
         SR    R15,R15                                                  01286
         B     PP030                                                    01287
PP020    EQU   *                                                        01288
         SLR   R15,R14                                                  01289
         LA    R15,1(0,R15)                                             01290
PP030    EQU   *                                                        01291
         BR    R1                                                       01292
         SPACE 3                                                        01293
PP100    EQU   *                   ROUTINE TO EDIT EBCDIC NUMERIC       01294
         LTR   R15,R15                 DATA AND, IF VALID, TO CONVERT   01295
         BNP   PP120                   IT TO BINARY.                    01296
         ST    R15,DBLWORD             AT ENTRY R1 CONTAINS THE RETURN  01297
         ALR   R15,R14                 ADDRESS.  R14 CONTAINS DATA      01298
PP110    EQU   *                       ADDRESS.  R15 CONTAINS LENGTH    01299
         BCTR  R15,0                   OF DATA.  AT NORMAL EXIT, R15    01300
         CLI   0(R15),C'0'             WILL BE ALTERED TO CONTAIN THE   01301
         BL    QQ000                   BINARY EQUIVALENT OF THE NUMBER. 01302
         CLI   0(R15),C'9'                                              01303
         BH    QQ000                   AN ABNORMAL EXIT WILL BE TAKEN   01304
         CLR   R15,R14                 TO THE COMMON ERROR ROUTINE IF   01305
         BH    PP110                   DATA IS NOT NUMERIC.             01306
         L     R15,DBLWORD                                              01307
         BCTR  R15,0                                                    01308
         EX    R15,PACKNUM                                              01309
         CVB   R15,DBLWORD                                              01310
PP120    EQU   *                                                        01311
         BR    R1                                                       01312
         SPACE 1                                                        01313
PACKNUM  PACK  DBLWORD,0(0,R14)                                         01314
         EJECT                                                          01315
QQ000    EQU   *                                                        01316
         LR    R0,R7               SET UP RETURN CODES                  01317
         LA    R15,15                                                   01318
         B     ZZ000                                                    01319
         SPACE 3                                                        01320
ZZ000    EQU   *                                                        01321
         LR    R1,R13              PREPARE FOR FREEMAIN.                01322
         L     R13,SAVEAREA+4                                           01323
         LTR   R11,R11             CHECK TO SEE IF PARAMETER LIST IS    01324
         BNP   ZZ010                   ONLY ENTRY IN CALLER'S ADDRESS   01325
         L     R2,24(0,R13)            LIST.                            01326
         L     R2,4(0,R2)          GET SECOND ADDRESS IN LIST.          01327
         ST    R0,0(0,R2)          PUT REGISTER INFORMATION IN LIST.    01328
         ST    R15,4(0,R2)                                              01329
ZZ010    EQU   *                                                        01330
         LR    R2,R0               SAVE CONTENTS OF REGISTERS.          01331
         LR    R3,R15                                                   01332
         L     R0,WORKLEN                                               01333
FREE1    FREEMAIN RU,LV=(0),A=(1),RELATED='GET1'                        01334
         LR    R0,R2                                                    01335
         LR    R15,R3                                                   01336
         L     R14,12(0,R13)                                            01337
         RETURN (1,12),RC=(15)                                          01338
WORKLEN  DC    F'1024'                                                  01339
TXPTRSPC DC    A(4*40)             RESERVE SPACE FOR 40 TEXT POINTERS.  01340
BLANKS   DC    CL44' '                                                  01341
NULLS    DC    XL44'00'                                                 01342
         LTORG                                                          01343
         EJECT                                                          01344
PARMLIST DSECT                                                          01345
DDNAME   DS    CL8                                                      01346
DSNAME   DS    CL44                                                     01347
DSMEMBER DS    CL8                                                      01348
PASSWORD DS    CL8                                                      01349
DSSTATUS DS    CL8                                                      01350
DSNDISP  DS    CL8                                                      01351
DSADISP  DS    CL8                                                      01352
DSUNIT   DS    CL8                                                      01353
$RESERV1 DS    CL8                                                      01354
DSVOLSER DS    CL6                                                      01355
$RESERV2 DS    CL40                                                     01356
DSVOLREF DS    CL44                                                     01357
DSFREE   DS    CL8                                                      01358
DSLABEL  DS    CL4                                                      01359
DSINOUT  DS    CL4                                                      01360
$RESERV3 DS    CL16                                                     01361
DSPWDLBL DS    CL8                                                      01362
DSDATE   DS    CL12                                                     01363
DSALLOC  DS    CL5                                                      01364
DSPRI    DS    CL6                                                      01365
DSSEC    DS    CL6                                                      01366
DSDIR    DS    CL5                                                      01367
DSRLSE   DS    CL8                                                      01368
DSCONTIG DS    CL8                                                      01369
DSROUND  DS    CL8                                                      01370
$RESERV4 DS    CL24                                                     01371
DSBLKSI  DS    CL5                                                      01372
DSORG    DS    CL8                                                      01373
DSKEYLEN DS    CL3                                                      01374
DSLRECL  DS    CL5                                                      01375
DSRECFM  DS    0CL8                                                     01376
DSRECFM1 DS    C                                                        01377
DSRECFM2 DS    C                                                        01378
DSRECFM3 DS    C                                                        01379
DSRECFM4 DS    C                                                        01380
DSRECFM5 DS    C                                                        01381
DSRECFM6 DS    C                                                        01382
DSRECFM7 DS    C                                                        01383
DSRECFM8 DS    C                                                        01384
DSDCBDS  DS    CL44                                                     01385
$RESERV5 DS    CL24                                                     01386
PARMEND  EQU   *                                                        01387
         SPACE 3                                                        01388
WORKAREA DSECT                                                          01389
SAVEAREA DS    18F                                                      01390
REQBKPTR DS    F                                                        01391
WKRTNVOL DS    F                                                        01392
WKRTDSRG DS    F                                                        01393
         DS    F                                                        01394
DBLWORD  DS    D                                                        01395
         DS    4F                                                       01396
DYNWORK  EQU   *                                                        01397
         EJECT                                                          01398
         IEFZB4D0                                                       01399
         EJECT                                                          01400
         IEFZB4D2                                                       01401
         END                                                            01402
